!function(){"use strict";const t=()=>{const t={[Symbol.iterator](){const t=Object.values(this);let e=Object.keys(this);return{next(){if(e<t.length){const n=t[e];return e++,{value:n,done:!1}}return{done:!0}}}}};return Array.prototype.forEach.call(JSON.parse(formidableAbandonedGlobal.formSettings),(e=>{t[e.form_id]=document.querySelector("#frm_form_"+e.form_id+"_container form")})),t},e=t=>document.querySelector(`#frm_form_${t}_container form`),n=t=>{const n=e(t),o=new FormData(n),a={item_meta:{},empty:!0};let c,l={};for(const[t,e]of o.entries()){if(t.includes("item_meta")){l={},""!==e&&(a.empty=!1);let n=t.replace("item_meta","").replaceAll("[","").split("]");if(n.pop(n.length-1),n.length<=1){a.item_meta[t.replace(/\D+/g,"")]=e;continue}c===t&&(n=n.map((t=>""===t?1:t))),r(l,n,e),s(a.item_meta,l)}else a[t]=e;c=t}return i(n,a),a},i=(t,e)=>Object.assign(e,{antispam_token:t.dataset.token}),r=(t,e,n)=>{e.reduce(((t,i,r)=>(void 0===t[i]&&r!==e.length-1&&(t[i]={}),r===e.length-1?(t[i]=n,n):t[i])),t)},o=t=>t&&"object"==typeof t&&!Array.isArray(t);function s(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(!n.length)return t;const r=n.shift();if(o(t)&&o(r))for(const e in r)o(r[e])?(t[e]||Object.assign(t,{[e]:{}}),s(t[e],r[e])):Object.assign(t,{[e]:r[e]});return s(t,...n)}var a=function(t){return"string"!=typeof t||""===t?(console.error("The namespace must be a non-empty string."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(t)||(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)};var c=function(t){return"string"!=typeof t||""===t?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(t)?(console.error("The hook name cannot begin with `__`."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(t)||(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)};var l=function(t,e){return function(n,i,r,o=10){const s=t[e];if(!c(n))return;if(!a(i))return;if("function"!=typeof r)return void console.error("The hook callback must be a function.");if("number"!=typeof o)return void console.error("If specified, the hook priority must be a number.");const l={callback:r,priority:o,namespace:i};if(s[n]){const t=s[n].handlers;let e;for(e=t.length;e>0&&!(o>=t[e-1].priority);e--);e===t.length?t[e]=l:t.splice(e,0,l),s.__current.forEach((t=>{t.name===n&&t.currentIndex>=e&&t.currentIndex++}))}else s[n]={handlers:[l],runs:0};"hookAdded"!==n&&t.doAction("hookAdded",n,i,r,o)}};var u=function(t,e,n=!1){return function(i,r){const o=t[e];if(!c(i))return;if(!n&&!a(r))return;if(!o[i])return 0;let s=0;if(n)s=o[i].handlers.length,o[i]={runs:o[i].runs,handlers:[]};else{const t=o[i].handlers;for(let e=t.length-1;e>=0;e--)t[e].namespace===r&&(t.splice(e,1),s++,o.__current.forEach((t=>{t.name===i&&t.currentIndex>=e&&t.currentIndex--})))}return"hookRemoved"!==i&&t.doAction("hookRemoved",i,r),s}};var d=function(t,e){return function(n,i){const r=t[e];return void 0!==i?n in r&&r[n].handlers.some((t=>t.namespace===i)):n in r}};var h=function(t,e,n=!1){return function(i,...r){const o=t[e];o[i]||(o[i]={handlers:[],runs:0}),o[i].runs++;const s=o[i].handlers;if(!s||!s.length)return n?r[0]:void 0;const a={name:i,currentIndex:0};for(o.__current.push(a);a.currentIndex<s.length;){const t=s[a.currentIndex].callback.apply(null,r);n&&(r[0]=t),a.currentIndex++}return o.__current.pop(),n?r[0]:void 0}};var f=function(t,e){return function(){var n;const i=t[e];return null!==(n=i.__current[i.__current.length-1]?.name)&&void 0!==n?n:null}};var m=function(t,e){return function(n){const i=t[e];return void 0===n?void 0!==i.__current[0]:!!i.__current[0]&&n===i.__current[0].name}};var p=function(t,e){return function(n){const i=t[e];if(c(n))return i[n]&&i[n].runs?i[n].runs:0}};class v{constructor(){this.actions=Object.create(null),this.actions.__current=[],this.filters=Object.create(null),this.filters.__current=[],this.addAction=l(this,"actions"),this.addFilter=l(this,"filters"),this.removeAction=u(this,"actions"),this.removeFilter=u(this,"filters"),this.hasAction=d(this,"actions"),this.hasFilter=d(this,"filters"),this.removeAllActions=u(this,"actions",!0),this.removeAllFilters=u(this,"filters",!0),this.doAction=h(this,"actions"),this.applyFilters=h(this,"filters",!0),this.currentAction=f(this,"actions"),this.currentFilter=f(this,"filters"),this.doingAction=m(this,"actions"),this.doingFilter=m(this,"filters"),this.didAction=p(this,"actions"),this.didFilter=p(this,"filters")}}const b=function(){return new v}(),{addAction:_,addFilter:y,removeAction:g,removeFilter:A,hasAction:k,hasFilter:F,removeAllActions:I,removeAllFilters:S,doAction:D,applyFilters:E,currentAction:O,currentFilter:U,doingAction:w,doingFilter:x,didAction:j,didFilter:L,actions:R,filters:$}=b,q=(t,e)=>JSON.parse(formidableAbandonedGlobal.formSettings).find((e=>e.form_id===t))[e];var T=function(){this.eligible=!1,this.formID=null,this.callBack=null,this.bind=function(){this.isEligible()&&this.callBack()},this.isEligible=function(){return this.eligible},this.visibilitychange=function(){document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.bind()}))},this.saveOnInterval=function(){const t=E("frm_auto_save_interval",1e4);setInterval((()=>{"visible"===document.visibilityState&&this.bind()}),t)},this.isFormManipulated=function(){e(this.formID).addEventListener("change",(()=>{this.eligible=!0}))},this.isFormSubmitted=function(){e(this.formID).addEventListener("submit",(t=>{t.target.classList.contains("frm_final_submit")&&(this.eligible=!1)}))},this.isEmailRequiredEnabled=function(){return q(this.formID,"abandon_email_required")},this.observeFields=function(){const t=q(this.formID,"observable_fields").map((t=>document.querySelector(`[name="item_meta[${t}]"]`)));Array.prototype.forEach.call(t,(t=>{t.addEventListener("keyup",(()=>{t.value&&(this.eligible=!0)})),t.value&&(this.eligible=!0)}))},this.init=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formID,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.callBack;this.formID=t,this.callBack=e,this.isFormSubmitted(),!0===this.isEmailRequiredEnabled()?this.observeFields():this.isFormManipulated(),this.saveOnInterval(),this.visibilitychange()}};var B={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let z;const Z=new Uint8Array(16);function C(){if(!z&&(z="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(Z)}const G=[];for(let t=0;t<256;++t)G.push((t+256).toString(16).slice(1));function J(t,e=0){return G[t[e+0]]+G[t[e+1]]+G[t[e+2]]+G[t[e+3]]+"-"+G[t[e+4]]+G[t[e+5]]+"-"+G[t[e+6]]+G[t[e+7]]+"-"+G[t[e+8]]+G[t[e+9]]+"-"+G[t[e+10]]+G[t[e+11]]+G[t[e+12]]+G[t[e+13]]+G[t[e+14]]+G[t[e+15]]}var M=function(t,e,n){if(B.randomUUID&&!e&&!t)return B.randomUUID();const i=(t=t||{}).random||(t.rng||C)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return J(i)};const N={createCookie(t,e){const n="https:"===document.location.protocol?";secure":"";document.cookie=`${t}=uuid-${e};expires=-1;path=/;samesite=strict${n}`}},V=t=>{var e;return null===(e=document.cookie.split("; ").find((e=>e.startsWith(t))))||void 0===e?void 0:e.split("=")[1]};function W(t,e){if(!0===e.empty)return;delete e.empty;const n=new FormData;n.append("_frmuuid",V("_frmuuid")),n.append("form_id",t),n.append("data",JSON.stringify(e)),n.append("action","frm_abandoned"),n.append("task","send_analytics"),window.navigator.sendBeacon(formidableAbandonedGlobal.ajaxUrl,n)}var H;H=()=>{V("_frmuuid")||N.createCookie("_frmuuid",M()),K()},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",H):H());const K=()=>{const e=t();for(const t in e){if(null===e[t])continue;(new T).init(t,(()=>{W(t,n(t))}))}}}();